{"version":3,"sources":["accessibility.js"],"names":["addAlert","nav_current","navigate","currentScreen","index","nav_all","pages","length","controlAcessibilityModal","ignoreId","$","modal","this","each","$botao","on","attr","console","i","element","closeModal","log","openModal","window","focusin","hasClass","css","keyup","evt","trigger","_elemTabModal","item","ind","_modalCurrent","document","activeElement","tabIndex","tabCurrent","parseInt","keyToTabActive","tabItem","st","find","last","which","focus","fixTabIndexInComponents","onePageTabIndexFix","removeOldAlert","newAlert","createElement","setAttribute","msg","focusPrev","selectPrevTabbableOrFocusable","selectNextTabbableOrFocusable","selectables","nextIndex","current","currentIndex","setTimeout","prevIndex","oldAlert","getElementById","ready","events","createAriaPageInit","controlNavWereTab","get","pause","_this","indice","selector","eq","isTabIndexNotNaN","nodeName","map","parentNode","mapName","visible","focusable","img","toLowerCase","isNaN","name","href","test","disabled","expr","filters","parents","addBack","filter","focusNext","match","tabNext","tabPrev","extend","data","createPseudo","dataName","elem","jQuery","tabbable","isTabIndexNaN"],"mappings":"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","file":"accessibility.js","sourcesContent":["$(document).ready(function() {\n\taddAlert(\"Aguarde, carregando!\");\n});\n\nevents.on('ready', function() {\n\t\n\tsetTimeout(function() {\n\n\t\t\tcreateAriaPageInit();\n\t\t\tonePageTabIndexFix();\n\t\t\tfixTabIndexInComponents();\n\t\t\tcontrolAcessibilityModal();\n\t\t\tcontrolNavWereTab();\n\n\t}, 1000 * 1);\n});\n\nfunction createAriaPageInit() {\n\tvar nav_current = navigate.currentScreen.index + 1;\n\tvar nav_all = navigate.currentScreen.pages.length;\n\n\tif (nav_all > 1) {\n\t\t\tif (nav_current == 1) {\n\t\t\t\t\taddAlert(`Carregamento finalizado! Você está na página ${nav_current} de ${nav_all}. Para navegar no treinamento utilize apenas o TAB.`);\n\t\t\t} else {\n\t\t\t\t\taddAlert(`Carregamento finalizado! Você está na página ${nav_current} de ${nav_all}.`);\n\t\t\t}\n\t}\n}\n\n\nfunction hiddenElementesFromReader(ignoreId) {\n\t$(\"*\").each(function() {\n\t\t\tif ($(this) != $(ignoreId)) {\n\t\t\t\t\t$(this).attr(\"aria-hidden\", \"true\");\n\t\t\t\t\t$(this).attr(\"tabindex\", \"-1\");\n\t\t\t}\n\t});\n}\n\nfunction controlAcessibilityModal() {\n\t\n    var modal= null;\n    $(\"[data-modal]\").each(function (i, element){\n        var $botao = $(element);\n        $botao.on('click', function () {\n            console.log(\"open modal: \" + $(this).attr('data-modal') );\n            modal = $( $(this).attr('data-modal') );\n            openModal(modal);\n        });\n    });\n\n    $(\"*\").focusin(function () {\n        if ($(this).hasClass(\"modal-close\")) {\n            console.log(\"close modal\");\n\t\t\t\t\t\t$('.modal').css('display', 'none');\n            closeModal();\n        }\n    });\n\n\t\t/// liberar o close para Acessibildade com qualquer evento do teclado.\n\t\t$(window).keyup(function(evt) {\n\t\t\t$('body').trigger('alertAccessibility');\n\t\t})\n}\n\n$('body').on('hide-header', function(){\n\t// $('.header .control-01').css('display', 'none');\n\t// $('.header .control-02').css('display', 'none');\n\t// $('.btnHelp').css('display', 'none');\n})\n\n\n$('body').on('show-header', function(){\n\t// $('.header .control-01').css('display', 'flex');\n\t// $('.header .control-02').css('display', 'flex');\n\t// $('.btnHelp').css('display', 'flex');\n\t$(\"video\").each(function(){\n\t\t\t$(this).get(0).pause();\n\t});\n})\n\n$('body').on('modal-open', function(_this, modal){\n\topenModal(modal);\n})\n\n$('body').on('modal-close', function(_this, modal){\n\tcloseModal();\n})\n\nfunction openModal(_modalCurrent) {\n\n\t$('body').trigger('hide-header');\n\taddAlert(\"Janela de conteúdo aberta.\");\n\n\tvar _elemTabModal = {\n\t\t\tind: 99999999,\n\t\t\titem: null,\n\t\t\tlast: 0,\n\t\t\tst: false\n\t};\n\n\t//grava o ultimo tabindex antes de entrar no modal\n\t$('body').attr('tabIndexModal', document.activeElement.tabIndex);\n\n\t_modalCurrent.find('.modal-close').attr(\"tabindex\", -1);\n\t_modalCurrent.find(\"*\").each(function(indice, item) {\n\t\t\tif (parseInt($(item).attr('tabindex')) > -1) {\n\n\t\t\t\t\t///grava o maior dos tab index dentro do modal para referenciar o btn de Fechar\n\t\t\t\t\t_elemTabModal.last = parseInt($(item).attr('tabindex')) + 1;\n\t\t\t\t\tif (_elemTabModal.st == false ) {\n\t\t\t\t\t\t\t_elemTabModal.ind = $(item).attr('tabindex');\n\t\t\t\t\t\t\t_elemTabModal.item = $(item);\n\t\t\t\t\t\t\t_elemTabModal.st = true; \n\t\t\t\t\t}\n\t\t\t}\n\t});\n\n\t_modalCurrent.find('.modal-close').attr(\"tabindex\", _elemTabModal.last);\n\t_modalCurrent.find('.modal-close').attr(\"aria-label\", \"Fechar modal.\");\n\n\t_elemTabModal.item.focus();\n\n}\n\nfunction closeModal() {\n\n\t$('body').trigger('show-header');\n\taddAlert(\"Janela de conteúdo fechada.\");\n\t// recupera o ultimo tabindex antes de entrar no modal\n\tvar tabCurrent = parseInt($('body').attr('tabIndexModal'));\n\tdocument.activeElement.tabIndex = tabCurrent;\n\n\tif (window.keyToTabActive) {\n\t\t\t$(\"*\").each(function() {\n\t\t\t\t\tvar tabItem = parseInt($(this).attr('tabindex'));\n\t\t\t\t\tif (tabCurrent == tabItem) {\n\t\t\t\t\t\t\t$(this).focus();\n\t\t\t\t\t}\n\t\t\t});\n\t}\n\n\n}\n\nfunction controlNavWereTab() {\n\t$(window).keyup(function(evt) {\n\t\t\tif (evt.which == 37 || evt.which == 38) {\n\t\t\t\t\t//PREV\n\t\t\t\t\t$.tabPrev();\n\t\t\t}\n\n\t\t\tif (evt.which == 39 || evt.which == 40) {\n\t\t\t\t\t//NEXT\n\t\t\t\t\t$.tabNext();\n\t\t\t\t\twindow.keyToTabActive = true;\n\t\t\t}\n\t});\n}\n\nfunction fixTabIndexInComponents() {\n\t$('button').find(\"*\").each(function() {\n\t\t\t$(this).attr(\"tabindex\", '-1');\n\t});\n\t$('a').find(\"*\").each(function() {\n\t\t$(this).attr(\"tabindex\", '-1');\n\t});\n}\n\nfunction onePageTabIndexFix() {\n\t$(\"*\").each(function() {\n\t\t\tvar tabItem = parseInt($(this).attr('tabindex'));\n\t\t\tif ( tabItem == 1 && !$(this).hasClass('modal-close')) {\n\t\t\t\t\t$(this).focus();\n\t\t\t}\n\t});\n}\n\nfunction addAlert(aMsg) {\n\tremoveOldAlert();\n\tvar newAlert = document.createElement(\"div\");\n\tnewAlert.setAttribute(\"role\", \"alert\");\n\tnewAlert.setAttribute(\"id\", \"alert\");\n\tvar msg = document.createTextNode(aMsg);\n\tnewAlert.appendChild(msg);\n\tdocument.body.appendChild(newAlert);\n\t$(\"#alert\").css(\"opacity\", \"0\");\n\n\tsetTimeout(function() {\n\t\t\tremoveOldAlert();\n\t}, 4000);\n}\n\nfunction removeOldAlert() {\n\tvar oldAlert = document.getElementById(\"alert\");\n\tif (oldAlert) {\n\t\t\tdocument.body.removeChild(oldAlert);\n\t}\n}\n\n\n(function($){\n\t'use strict';\n\t$.focusNext = function(){\n\t\tselectNextTabbableOrFocusable(':focusable');\n\t};\n\t$.focusPrev = function(){\n\t\tselectPrevTabbableOrFocusable(':focusable');\n\t};\n\t$.tabNext = function(){\n\t\tselectNextTabbableOrFocusable(':tabbable');\n\t};\n\t$.tabPrev = function(){\n\t\tselectPrevTabbableOrFocusable(':tabbable');\n\t};\n\n\tfunction selectNextTabbableOrFocusable(selector){\n\t\tvar selectables = $(selector);\n\t\tvar current = $(':focus');\n\t\tvar nextIndex = 0;\n\t\tif(current.length === 1){\n\t\t\tvar currentIndex = selectables.index(current);\n\t\t\tif(currentIndex + 1 < selectables.length){\n\t\t\t\tnextIndex = currentIndex + 1;\n\t\t\t}\n\t\t}\n\n\t\tselectables.eq(nextIndex).focus();\n\t}\n\n\tfunction selectPrevTabbableOrFocusable(selector){\n\t\tvar selectables = $(selector);\n\t\tvar current = $(':focus');\n\t\tvar prevIndex = selectables.length - 1;\n\t\tif(current.length === 1){\n\t\t\tvar currentIndex = selectables.index(current);\n\t\t\tif(currentIndex > 0){\n\t\t\t\tprevIndex = currentIndex - 1;\n\t\t\t}\n\t\t}\n\n\t\tselectables.eq(prevIndex).focus();\n\t}\n\t$.extend($.expr[ ':' ], {\n\t\tdata: $.expr.createPseudo ?\n\t\t\t$.expr.createPseudo(function(dataName){\n\t\t\t\treturn function(elem){\n\t\t\t\t\treturn !!$.data(elem, dataName);\n\t\t\t\t};\n\t\t\t}) :\n\t\t\tfunction(elem, i, match){\n\t\t\t\treturn !!$.data(elem, match[ 3 ]);\n\t\t\t},\n\n\t\tfocusable: function(element){\n\t\t\treturn focusable(element, !isNaN($.attr(element, 'tabindex')));\n\t\t},\n\n\t\ttabbable: function(element){\n\t\t\tvar tabIndex = $.attr(element, 'tabindex'),\n\t\t\t\tisTabIndexNaN = isNaN(tabIndex);\n\t\t\treturn ( isTabIndexNaN || tabIndex >= 0 ) && focusable(element, !isTabIndexNaN);\n\t\t}\n\t});\n\n\t/**\n\t * focussable function, taken from jQuery UI Core\n\t * @param element\n\t * @returns {*}\n\t */\n\tfunction focusable(element){\n\t\tvar map, mapName, img,\n\t\t\tnodeName = element.nodeName.toLowerCase(),\n\t\t\tisTabIndexNotNaN = !isNaN($.attr(element, 'tabindex'));\n\t\tif('area' === nodeName){\n\t\t\tmap = element.parentNode;\n\t\t\tmapName = map.name;\n\t\t\tif(!element.href || !mapName || map.nodeName.toLowerCase() !== 'map'){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\timg = $('img[usemap=#' + mapName + ']')[0];\n\t\t\treturn !!img && visible(img);\n\t\t}\n\t\treturn ( /^(input|select|textarea|button|object)$/.test(nodeName) ?\n\t\t\t!element.disabled :\n\t\t\t'a' === nodeName ?\n\t\t\t\telement.href || isTabIndexNotNaN :\n\t\t\t\tisTabIndexNotNaN) &&\n\t\t\tvisible(element);\n\n\t\tfunction visible(element){\n\t\t\treturn $.expr.filters.visible(element) && !$(element).parents().addBack().filter(function(){\n\t\t\t\treturn $.css(this, 'visibility') === 'hidden';\n\t\t\t}).length;\n\t\t}\n\t}\n})(jQuery);\n"]}